# Unitree-Aliengo

## Включение робота

Положите робота в стартовую позицию: корпус лежит на земле горизонтально, без наклона, пластиковые подставки на животе робота плотно прилегают к земле. Ноги робота собран так, что четыре локтевых/коленных сустава и резиновые ступни касаются земли.

Убедитесь что батарея робота и пульта полностью заряжены.

Запуск робота: одно короткое нажатие на кнопку питания на аккумуляторе, второе нажатие длинное - порядка 5 секунд. 
Включение пульта: одно короткое нажатие и одно длинное (пульт нужно включить, даже если не собираетесь с него управлять — иначе будут проблемы с отправкой команд через сдк)

После включения робот находится в стандартном режиме (low-level). В этом режиме можно управлять напрямую моторами через unitree_legged_sdk. 

Подробнее:
https://robodocs.3logic.ru/docs/Unitree%20Robotics/AlienGo/aliengo_general.html

Что делать в экстренной ситуации:

| Экстренная ситуация | Действие | Результат
|---|---|---|
| Робот дергается так, что к нему не подойти (скрипт или политика косячные) | На пульте со стиками нажать L2+B | Моторы расслабятся, и робот осядет на землю |
| Что-то пошло не так, задымился мотор, завис робот и т. д.  | Сразу вытаскиваем аккумулятор! Или сначала выключаем кнопкой, а потом - вытаскиваем аккумулятор | |

## Управление роботом

После включения робот самостоятельно встает и находится в стандартном режиме. В этом режиме робот может стоять, ходить и вращать телом, но делает это неустойчиво. Режим предназначен для разработчиков своей походки, поэтому для управления с пульта требуется перейти в спортивный режим, чтобы использовать официальную программу управления движением.

Переключение в спортивный режим происходит из положения лежа. Полная последовательность действий для перехода в спортивный режим следующая:

- нажать 3 раза L2 + A - робот ложится на пол
- нажать L1 + Start - непосредственно включение спортивного режима. После чего робот поднимется
- нажать кнопку Start - робот начнет ходьбу на месте.

Теперь можно двигать стиками чтобы робот перемещался.

Индикатором успешного перехода в спортивный режим послужит более ускоренное и уверенное перемещение собаки, а также более частое перебирание лап на месте. Если вы хотите улучшить стабильность и маневренность робота при перемещении, то этот режим наиболее оптимален.

## Полный перечень команд 

| Кнопка         | Описание                                                                                                                               |
|----------------|----------------------------------------------------------------------------------------------------------------------------------------|
| L2 + Y         | Переворот через бок (ВПРАВО)                                                                                                          |
| L2 + X         | Подъем со спины после падения (ВПРАВО)                                                                                                |
| L2 + A         | Лечь/встать/полуприсед. В **спортивном** режиме положение *полуприсед* отсутствует. Во всех положения суставы зафиксированы (это подходит для переноски) |
| L2 + B         | Расслабить двигатели (использовать только в положении лежа или во время нештатной ситуации)                                           |
| L1 + R1        | Небольшой прыжок вверх на месте                                                                                                       |
| ↑ ↓            | Изменение высоты тела над землей                                                                                                       |
| Start          | Переход в режим ходьбы и обратно                                                                                                      |
| L2 + Start     | Переход в режим бега                                                                                                                  |
| L1 + Start     | Переход в **спортивный** режим                                                                                                         |
| L1 + L2 + Start| Переход в **стандартный** режим (отключение **спортивного** режима)                                                                   |
| Start          | Переход в статичный режим                                                                                                              |
| Select         | Переход в режим вращения телом                                                                                                         |
| L1 + ↑ ↓       | Изменение высоты подъема лапы при ходьбе                                                                                              |
| L2 + Start     | Переход в режим подъема по лестнице (только из **спортивного** режима) / переход обратно в **спортивный** режим                      |

## Переход: Спортивный режим → Стандартный режим

Для перехода обратно в стандартный режим:

- Нажать L2 + A несколько раз, до того момента, пока робот не примет положение лежа
- L2 + B - робот перестал шуметь
- L1 + L2 + Start - непосредственно отключение спортивного режима
- Зажать L2 и нажать 2 раза кнопку B
- Зажать L2 и нажать 2 раза кнопку А

## Код для работы с Aliengo

1. Официальное сдк
https://github.com/unitreerobotics/unitree_legged_sdk/tree/Aliengo	

2. Проект для запуска скриптов и рл-политик на робособаке через сдк + в симуляторе mujoco (официальное сдк есть в проекте rl_go1 в качестве подмодуля):
https://github.com/pendragon707/rl_go1

3. RMA
Проект для обучения RL-политик для Unitree Aliengo
https://github.com/pendragon707/raisimLib

## Снятие логов c Aliengo

1. Подключиться к RS-485 разъёму Aliengo (переходник RS-485 - USB есть в чемодане)

![1](/images/1.png "1")

2. При подключении к роботу появляется терминал /dev/ttyUSB0

![2](/images/2.png "2")

Установить PuTTY:

```bash
sudo apt update
sudo apt install putty
```

Запустить PuTTY с порта Aliengo

```bash
sudo putty /dev/ttyUSB0 -serial -sercfg 115200,8,n,1,N
```

где:
`/dev/ttyUSB0` - терминал, который появляется при подключении к Aliengo через RS-485
`115200` - скорость передачи данных
`8,n,1,N` - формат кадра
	
После отправки команды появляется окно, в которое в реальном времени выводятся логи:

![3](/images/3.png "3")

Материалы:
https://robodocs.3logic.ru/docs/Unitree%20Robotics/AlienGo/aliengo_get_logs.html

## Доступ к камере Aliengo

На Aliengo есть:
- 2 инфракрасные камеры - Intel Realsense D435i 
- Камера одометрии - Intel Realsence T265






## Полезные материалы
Документация и разное
https://drive.google.com/drive/folders/1LXvSTHD2Fv9Eu8THsu8kQpHDs2XjbYZg?usp=sharing
	
### Про сдк

- Официальное сдк для управления Unitree Aliengo (оно есть в проекте rl_go1 в качестве подмодуля):
https://github.com/unitreerobotics/unitree_legged_sdk/tree/Aliengo	

- Инструкция на русском (в том числе про управление с пульта)
https://robodocs.3logic.ru/docs/Unitree%20Robotics/AlienGo/aliengo_general.html

- Документация
https://unitree-docs.readthedocs.io/en/latest/Aliengo/AlienGo.html

- Документация про сдк моторов
https://support.unitree.com/home/en/Motor_SDK_Dev_Guide/control_mode
	 			 			
### Про РЛ
- Воркшоп по обучению и запуску рл-политики на робособаке
Используется симулятор IsaacGym, робособаку учат сидеть
https://github.com/StarkitRobots/workshop_legged_gym/tree/workshop

https://drive.google.com/file/d/1P74rLRLfFPB3tsmI4Sh1NhqNrNqzQpDX/view?usp=sharing

- Примеры с go1 в mujoco.
Можно изучить, какие награды используются, чтобы научить робособаку ходить на двух лапах и ходить по джойстику
https://colab.research.google.com/github/google-deepmind/mujoco_playground/blob/main/learning/notebooks/locomotion.ipynb
https://github.com/google-deepmind/mujoco_playground/tree/main/mujoco_playground/_src/locomotion/go1

- URDF 
Отсюда можно брать модели роботов, чтобы после на основе них обучать RL-политики

Gazebo
https://github.com/unitreerobotics/unitree_ros/tree/master/robots

https://github.com/unitreerobotics/unitree_rl_gym/tree/main/resources/robots

Mujoco
https://github.com/unitreerobotics/unitree_mujoco/tree/main/unitree_robots